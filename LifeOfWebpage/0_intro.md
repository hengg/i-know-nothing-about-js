![tide](img/tide.jpg)
## 起航

每天我都会在Chrome的地址栏中敲进许许多多的字符，然后按下回车。过不了多久，Chrome就带我进入一个又一个的页面——有资料，有新闻，有视频——互联网和网页对于我们来说就像是自来水和电那样自然而然。

然而这一切究竟是怎么发生的？我为什么要在浏览器里敲进一大堆字符？按下回车后发生了什么？下面就简单的介绍一下存放在大洋彼岸服务器上的页面文件是怎样出现在我们面前的浏览器中。

### URL

在浏览器地址栏中显示的、类似于`https://zhuanlan.zhihu.com/hengg `这种格式的字符叫做`URL`（Uniform Resource Locator，统一资源定位符）。所有网络上的资源都可以通过URL来定位。
我的专栏主页就是一个典型的URL。URL由如下几部分构成：
- `https://` 声明协议类型为https。类似的协议类型还有http,ftp等等，它们是为了通过网络进行数据交换而建立的规则、标准或约定的集合。
- `zhuanlan.zhihu.com` 域名
- `443` 逻辑端口，通过不同的逻辑端口来区分不同的服务。一个IP地址的端口通过16bit进行编号，最多可以有65536个端口。https默认的端口号就是443，因此此处:443也可以省略；http默认端口号则是80.
- `/hengg` 代表zhuanlan.zhihu.com域名下的hengg路径及相应的资源文件。

在互联网上，只要有可用的URL，我们就能获取到相应的资源文件。

### DNS
在浏览器中输入URL并按下回车后，首先需要通过`DNS`（Domain Name System，域名系统）找到对应服务器的IP。DNS是互联网上作为域名和IP地址相互映射的一个分布式数据库，通过DNS我们能够直接访问域名而不是`10.222.45.33`这种不便记忆的IP地址，DNS会将域名解析为对应的IP地址。

一个域名可以对应多个IP，通过负载均衡技术返回最适合用户的IP。

### 请求
获取到IP端口号之后，浏览器就可以向服务器发送请求了。一个完整的请求由请求行，请求体，请求内容组成。以知乎专栏为例，浏览器发送的请求行为：
- 请求网址：`https://zhuanlan.zhihu.com`
- 请求方法：`GET`
- 远程地址：`116.211.167.187:443`
- 版本：`HTTP/1.1`
#### 请求方法
其中常用请求方法有如下几种：
- GET 请求指定的页面信息，并返回实体主体。常用方法
- HEAD 类似于get请求，只不过返回的响应中没有具体的内容，用于获取报头
- POST 向指定资源提交数据进行处理请求（例如提交表单或者上传文件）。数据被包含在请求体中。POST请求可能会导致新的资源的建立和/或已有资源的修改。常用方法
- PUT 从客户端向服务器传送的数据取代指定的文档的内容。
- DELETE 请求服务器删除指定的页面。
- PATCH 类似于PUT，但只更新浏览器所指定的数据
#### 请求头
请求头的关键参数如下：

- Host: zhuanlan.zhihu.com
- User-Agent: 用户操作系统及浏览器信息
- Accept: 文件类型，应该是浏览器可接受的MIME类型
- Accept-Language: 浏览器所希望的语言类型 
- Accept-Encoding: 编码方式
- Connection: 是否需要持久链接
- Cookie

#### 请求体：

在本例中没有请求体。请求头和请求体之间是一个空行，表示请求头已经结束，接下来的是请求体。用户登录时请求体可能如下：
```
username=admin&password=1234
```

### 响应
服务器收到浏览器发送的请求后进行相应的处理，并返回响应。响应由响应头，响应行和响应体组成。本例中响应行如下：
```
协议 HTTP/1.1
状态码 200
```
#### 状态码
状态码服务器的响应状态，由三位整数组成，分为五种：
- 1xx：指示信息，表示请求已接收，继续处理
- 2xx：成功，表示请求已经被成功接收，理解，接受
- 3xx：重定向，要完成请求必须进行更进一步的操作
- 4xx：客户端错误，请求有语法错误或请求无法实现
- 5xx：服务器端错误，服务器未能实现合法的请求

本例中200代表请求已成功。
#### 响应头：
- Content-Encoding: 响应体编码
- Content-Length: 响应体长度
- Content-Type: 响应体类型
- Date: Sun, 26 Feb 2017 02:39:32 GMT
- Last-Modified: Fri, 24 Feb 2017 11:02:29 GMT
- Server:服务器

#### 响应体
即我们所请求的页面文件：
```
<!doctype html>
<html> 
    ...
</html>
```
### 渲染
浏览器得到了服务器返回的响应体HTML文件，解析并渲染这个文件，这个网页才最终展现在我们面前。

*参考资料:*
- *[w3-url-spec](https://www.w3.org/Addressing/URL/url-spec.txt)*
- *[wikipedia-DNS](https://zh.wikipedia.org/wiki/%E5%9F%9F%E5%90%8D%E7%B3%BB%E7%BB%9F)*