# 代理
通常来说客户端不会直接与服务器建立连接。它们之间可能需要一个或多个“中间人”才能完成对话。这个“中间人”就是代理服务器。代理服务器接收客户端发送的请求并转发给服务器，同时接收服务器的响应并转发给客户端。代理相对客户端和下级代理来说就是服务器；相对服务器和上级代理来说就是客户端。

代理不仅仅是一个术语，它在生活当中也随处可见。最常见的代理就是路由器。常见代理的使用场景如下：

- 在企业内网/教育网等内网环境和外网进行通信大多通过代理，可以过滤想要阻止的内容，对联网的访问进行控制。你可能见过某些“连接超时，xxx的服务器响应时间过长”的页面，相信你已经知道它们是怎么回事儿了；
- 为了不被“连接超时”而广泛使用的各种梯子使用的也是代理技术；
- 有些黑客会使用多级代理来避免被追踪；
- 利用缓存技术减少冗余数据传输，缓解网络带宽压力

# 缓存
缓存是代理服务器或客户端保存的资源副本，利用缓存可减少对源服务器的访问，也就节省了流量和响应时间。缓存分为私有缓存和公有缓存两种。

- 最常见的私有缓存就是浏览器缓存。浏览器会在硬盘上专门开辟一个空间存储资源副本。如果在网站上访问一张被浏览器缓存过的图片，那么该图片将不再从服务器下载，而是从浏览器缓存中调出。
 
- 公有缓存一般是指代理服务器缓存，通常由大企业或ISP架设。其原理和浏览器缓存类似，当代理转发从服务器返回的响应时，代理就会保存一份资源副本。

缓存具有时效性，如果源服务器上的资源更新了，那么缓存自然也就过时了。所以通常会通过HTTP的`Cache-Control`首部为缓存指定最大生存时间；`Expires`首部指定过期日期。
即使存在缓存，也会因为客户端的要求、缓存的有效期等因素，向源服务器确认资源的有效性。若判断缓存失效，缓存服务器将会再次从源服务器上获取“新”资源。

关于缓存的高阶技巧： https://www.zhihu.com/question/20790576/answer/32602154

# Cookie和缓存
对于初学者来说，很容易把这两者弄混。所以我们也来简单介绍一下Cookie：
HTTP是无状态协议。它不会保存之前发生过的请求和响应的通信状态。也就是说，HTTP无法根据之前的状态进行本次的请求处理。由于不必保存状态，自然可减少服务器的 CPU 及内存资源的消耗。从另一侧面来说，也正是 因为 HTTP 协议本身是非常简单的，所以才会被应用在各种场景里。然而一个购物网站的用户如果每次向购物车添加商品都必须重新登录，显然是不合理的。为了保留无状态协议这个特征的同时又要解决类似的矛盾问题，HTTP引入了Cookie技术。

Cookie技术通过在请求和响应报文中写入Cookie信息来控制客户端的状态。
Cookie会根据从服务器端发送的响应报文内的一个叫做`Set-Cookie`的首部字段信息，通知客户端保存Cookie。当下次客户端再往该服务器 发送请求时，客户端会自动在请求报文中加入`Cookie`值后发送出去。
服务器端发现客户端发送过来的Cookie后，会去检查究竟是从哪一个客户端发来的连接请求，然后对比服务器上的记录，最后得到之前的状态信息。
      
那么Cookie和缓存的区别就很明显了：Cookie是响应报文的一个首部，而缓存则是资源的副本。如果把Cookie视作资源，那么它也是可以被缓存的。但通常不建议这么干。
